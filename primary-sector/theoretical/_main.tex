\documentclass{Academic}
\usepackage{csquotes}
\begin{document}
%Easy customisation of title page
%TC:ignore
    \myabstract{\include{abstract}}
    \renewcommand{\myTitle}{A Survey of State of the Art Crop Rotation Prediction Approaches}
    \renewcommand{\MyAuthor}{Leon Knorr}
    \renewcommand{\MyDepartment}{Mannheim Master of Datascience}
    \renewcommand{\ID}{1902854}
    \renewcommand{\Keywords}{Agriculture, AI, Crop Rotation}
    \maketitle
%\vspace{-1.9em}\noindent\rule{\textwidth}{1pt} %add this line if not using abstract
    %\onehalfspacing
%TC:endignore


    \section{Introduction}
    Agricultural systems are facing a wide range of challenges. This includes:
    \begin{itemize}
        \item feeding a growing population with limited space while keeping prices low~\cite{noauthor_oecd-fao_2021},
        \item following socio-cultural and lifestyle-driven trends towards a more sustainable and healthier diet offerings~\cite{noauthor_oecd-fao_2021},
        \item alleviating environmental pressures of intensive agriculture~\cite{upcott_new_2023},
        \item climate change and with that the rise of extreme weather events~\cite{upcott_new_2023},
        \item increasing pesticide resistance of pest species~\cite{curl_control_1963}
    \end{itemize}
    Most of these challenges have been around for decades, with less severe impacts on yield and profitability~\cite{curl_control_1963, upcott_new_2023}. In order to face these challenges, farmers recognised early on, that using a one-crop system leads to a decrease in yield and promote the emergence of plat diseases and pests. Thus, a Crop Rotation system was invented, where Farmers grew a wide variety of Crops in long circles in a specific order~\cite{noauthor_crop_2023, curl_control_1963}. This not only had a positive effect on yields, but it was also found, that some crop types did benefit each other, it also reduced the need to use extensive and expensive fertilization methods and was able to combat pests and diseases without chemical inputs~\cite{curl_control_1963}. However, in intensive agricultural systems, long crop rotation cycles have been replaced by intensive use of tillage, fertilizers and pesticides, in order to grow more profitable crops more frequently and ultimately increasing financial return~\cite{upcott_new_2023}. These practices have a big impact on the environment, affecting biodiversity, landscape design, decreasing soil properties and harm non-target species and habitats~\cite{upcott_new_2023, dury_models_2012}. Therfore, Crop Rotation techniques are making their return into agricultural systems. However, choosing the right crop and rotation cycle is a challenging task. It is spatially and temporal dependent, and involves a lot of uncertainty in terms of future weather, atmospheric properties and market development~\cite{upcott_new_2023, noauthor_crop_2023, pragathi_crop_nodate}. In addition, the decision maker needs a lot of specialized knowledge about different crop types, their relation, benefits and needs. To support actors that are concerned with deciding on Crop Rotation and Cropping Plans, current research is developing a variety of models, which promise to accurately predict the following crop or even whole crop rotation sequences. In this paper, different approaches to Crop Rotation prediction are summarized, explained and discussed with regards to different criteria. Ultimately all approaches are then categorized in terms of their usability and practical relevance.

    \section{Methodology}
    In the first section, crop rotation and their practical application is defined. In the second section, different approaches to crop prediction applications are outlined and compared in terms of:
    \begin{itemize}
        \item their methodology, this includes the categorization into three main categories: classic approaches, which use expert knowledge, data analysis which use traditional data mining and decision support methods and machine learning approaches.
        \item the input data the system is able to work with,
        \item their overall goals,
    \end{itemize}
    In the third section, the overall real world usability and practical relevance of the system is assessed and points for improvement are outlined.

    \section{Definitions \& Concepts} \label{sec:def}
    Before reviewing and presenting different approaches to crop rotation, this section will introduce the overall problem of crop rotation prediction, along with important definitions and real world applications, such as defining a cropping plan and what these decisions should involve.

    \subsection{Crop Rotation}
    Crop rotation is defined as the practice of growing a sequence of plant species on the same land over a \textit{cycling} period of time~\cite{noauthor_crop_2023, dury_models_2012}. It is characterised by a cycle period, while a crop sequence is limited to the order of appearance of a crop on the same land. The length of a rotation cycle varies. Simple crop rotations might only involve two or three years, while more complex ones can take up to twelve years~\cite{noauthor_crop_2023}. Because growing a crop has an impact on soil characteristics such as soil nutrient balance, choosing the right following crop is important. Choosing the right crop and ultimately designing a good crop rotation cycle enables agricultural systems to balance soil nutrient levels and increase soil fertility, enhance the soil structure, prevent soil erosion, break pest and disease cylces, improve weed management and ultimately improve yields and profitability, while keeping the impact to the environment to a minimum~\cite{noauthor_crop_2023}. It allows the design of a \textit{stable} temporal cropping system, which reduces the dependence on external inputs such as fertilizer and pesticides, allows the attenuation of environmental impact and maintains production achievements and profitability~\cite{dury_models_2012}. However, designing a good crop rotation cycle and applying it to every field on the farm is not feasable. Therefore, farmers define a Cropping Plan.

    \subsection{Cropping Plan}
    A cropping plan refers to the acreages occupied by all the different crops every year, and their spatial distribution within a farming land~\cite{dury_models_2012}. Thus, it handles which crop is growed where on the farm, in terms their actual allocation to a field / parcel and at the same time, it keeps track of the overall distribution of acreage per crop. The allocation of crops to fields, can be spatially explicit or be dependent on land are attributes such as the soil type or climate~\cite{dury_models_2012}. Depending on an actors area of responsibility, cropping plans can be expressed on different levels, e.g. it can be expressed on a farm level, handling all fields of a specific farm for a farmer, or it can be expressed at a higher level, to address collective issues, such as ressource usage, economy, food distribution etc. as it is important for countries or big agriculture companies. Traditionally a cropping plan is derived from crop proportions defined by crop rotation~\cite{dury_models_2012}.

    \subsection{Important Factors in Defining a Cropping Plan}
    As the cropping plan defines the overall allocation of land to certain crop types, a lot of factors play a role in designing a copping plan. During the rest of the paper, it is assumed that a cropping plan has to be created on a per farm level. First up, it involves the decision of which crops to grow, their allocation within the farmland them and their overall distribution over the farm. These three decisions are closely related to each other and all face different levels of uncertainty for different important factors.\\
    Choosing the right crop to grow is directly affected by multiple different factors. First, what is overall goal, that should be achieved with this crop? This question is directly dependent on the current market situation, as a farmer has to think about what market segments he wants to serve, this includes bio-fuels, food, live-stock self sufficiency etc \cite{noauthor_oecd-fao_2021}. This decision also has a direct impact on the quality that has to be achieved for a given crop. Optimally, farmers diversify their crop types, such that they can serve multiple segments at the same time, referring to the decision about crop distribution. However, this decision also involves uncertainty as the farmer does not know how the market will develop and how their crop might develop. It is therefore important, to take the different properties of crops into account. These include, the amount of rain, sun, humidity, soil type, soil nutrition levels, water, fertilizers etc. a given crop needs and what diseases and pests risks are associated with this~\cite{curl_control_1963, noauthor_crop_2023}. These factors are directly dependent on spatial factors, that involve crop allocation as they are soil and weather dependent. Of course, these factors also include a lot of uncertainty, such as the weather and depending on them generate different costs and yields. Additionally, different crops need different types of specialized equipment, that the farmer have to have on hand or would need to be rented. It is also common, that a year may include several sowing seasons, because of that, cropping plan decision-making, might involve multiple decision, that are directly dependent to each other, as they have to balance out the environmental impact of the previous crop, all by being profitable at the same time \cite{dury_models_2012}. As a result, a good cropping plan is strategic in terms of long-term production organisation and profitability and it has to be tactic, leaving possibilities for (intra-) annual adjustments in response to a changing uncertain environment \cite{dury_models_2012}.

    \section{Taxonomy of Crop Prediction Approaches}
    In this section, seven different approaches to crop rotation prediction are categorized based on their used methodology, input data and overall goals.

    \subsection{Methodology}
    The methodology of an approach is described by their used technologies and architectures. This includes, if a system is working rule / knowledge based (classic), if it learns from historic observations / data (machine learning) or if it can be derived directly without special model training (data analysis). First the classic approach to crop rotation prediction is outlined. Then current research based on data analysis is introduced and last but not least different state-of-the art machine learning approaches are presented.

    \subsubsection{Classic Approaches} % How was it done before Data Analytics
    Most cropping plans are developed by certified agronomists. Agronomists have studied the growing and harvesting of crops and thus have the expert knowledge required, to reason about the different factors playing into the decision of when and where to grow a selection of crops \cite{dupuis_methodology_2023}. Some countries even provide farmers with agronomists to help them establish stable, profitable and economically friendly cropping plans. As each decision in terms of crop choice and crop allocation is spatial and temporal dependent, agronomists use a variety of tools in addition to their aquired knowledge about crops properties and needs to aid their decisions. This includes, annual crop maps, which describe spatial dependent cropping patterns, soil maps \& sensors, which describe soil properties and average weather data, such as average rain and raining times, and the current market situation~\cite{upcott_new_2023}. Because of that, most decisions around defining a cropping plan are indirectly data-driven but their analysis is carried out manually.

    \subsubsection{Data Analysis} % Transfer Probability Matrices
    One approach to support agronomists and farmers by automating the analysis of already available and used data, is the creation of a spatial crop prediction framework, which can predict crop rotations on a field / parcel scale, as proposed by Upcott et. al~\cite{upcott_new_2023}. They derive Transition Probability Matrices (TPM) from a dataset of crop rotation sequences, which spans 6 years and has been extracted from publicly available annual crop maps. Each TPM has the unique series of $t-1$ previous crops in the t-year rotation as rows and 11 possible crops as columns. Thus, a TPM models $P(y|s_{t-1})$. In total, Upcott et. al. derived four different models based on TPMs.\\
    First, they used an approach which they call \enquote{spatial scaling}~\cite{upcott_new_2023}. Here, seperate TPMs for each $10\times 10$km grid cell have been created. Each entry to the TPM is thus defined using maximum likelyhood estimates as follows:
    $$\mathrm{TPM}_{s_{t-1},j} = \frac{N_{s_{t-1} \rightarrow j}}{N_{s_{t-1}}}$$
    As each TPM is spatially dependend, each TPM gives the probability of a crop field parcel belonging to crop type $j$, condition on the previous years of crops observed. \\
    Second, they proposed an approached based on the national average. For this, the full set of $10\times 10$km TPMs from the spatial scaling approach have been averaged, to produce one global TPM. After averaging each TPM elementwise, the rows of the final TPM have been rescaled to sum up to 1, to ensure appropriate probability based transitions~\cite{upcott_new_2023}. The idea behind this approach was originally to create a spatially indepedent base line representation, as the resulting TPM models crop rotations consistently across the whole (spatial) dataset. \\
    As a third approach, spatial smoothing has been proposed. During this, Upcott et. al incorporated spatial context based on kernel smoothing techniques into their crop rotation prediction system~\cite{upcott_new_2023}. It implies, that fields that are geographically close together, are more likely to undergo similar rotations. To accomplish this, weights were computed by calculating the distance between each grid cell and by applying a gaussian kernel as follows~\cite{upcott_new_2023}:
    \[w(x_i) = \frac{1}{\sqrt{2\pi}}\mathrm{exp}(-0.5(\frac{||x_i - x||_2}{h})^2),\]
    with $x$ being a given grid cell and $h$ is a smoothing parameter. Upcott et. al~\cite{upcott_new_2023}, proposed to set $h=25$km, as it maps approximately 95\% of the weights into a 100km radius around a grid cells centroid, composing the spatial context primarly of biophysical, socio-economic and political characteristics from this radius. This value has been chosen, as it represents the intermediate between the global and spacial scaling approach presented earlier~\cite{upcott_new_2023}, a domain driven explanation has not been given. The observed TPM was then computed by a weighted average across all grid cells.\\
    As mentioned before, the estimate to use 100km grid cells, wasn't based on any spatial or domain knowledge, instead a mathematical approximation was used to define a region of interest for each grid cell. To overcome this issue, Upcott et. al. proposed another final approach called \enquote{spatial classification}. Here, it is assumed, that rotational patterns of crops are more similar in region with similar environmental characteristics. To define areas with similar characterisitcs, the ITE Land Classification was used~\cite{upcott_new_2023} and classify all grid cells based on the 32 classes provided by it based on the dominant coverage. The TPMs of grid cells with the same class have then been averaged to compute a single, consistent TPM for the entire land~\cite{upcott_new_2023}.\\
    Finally, the TPMs were used to draw predictions on sequence input about the following crop by sampling with probabilities proportional to the values in the corresponding columns of the row corresponding to the input sequence. During the experiments presented in the paper, spatial scaling consistently gave the most accurate predictions~\cite{upcott_new_2023}.

    \subsubsection{Machine Learning} % Voting classifier, KNN, Decision Tree with GINI and Random Forest, RNNs
    In recent years, the domain of machine learning applications in agriculture systems has increased and current research aims at applying different machine learning schemas to support farmers and agronomists with accurate predictions in their decision making~\cite{rao_crop_2022, dupuis_performances_2023}. In the domain of crop rotation prediction, many researchers are starting to apply different machine learning techniques to predict the probable crop, from either the previous or a sequence of crops. Currently, many use simple approaches such as K-Nearest-Neighbour classifiers, decision trees and random forest, with only a small amount of research exploring the possibilities of deep learning~\cite{pragathi_crop_nodate, rao_crop_2022, dupuis_performances_2023}.\\
    Madhuri et. al.~\cite{rao_crop_2022} used multiple machine learning models to build an application which aims at supporting farmers in their decision making by first predicting an expected amount of rainfall using a support vector machine and feeding this information along with soil properties into different machine learning models to ultimately predict a crop for a given field based on their highest expected yield. As a first model, a K-nearest-neighbour classifier was used, which stores a query, along with every available crop type (multiple crops for each crop type are available)~\cite{rao_crop_2022}. The predicted class is then chosen based on the k nearest neighbours facilitating euclidean distance. As a second approach, a decision tree classifier using the Gini index and entropy has also been tested. This decision tree primarly remains unchanged, however, instead of deciding by arbitrary values that are greater or lower than the input, each split is evaluated by calculating the information gain as follows:
    \[\mathrm{Information Gain} = \mathrm{Entropy}(S) - I(\mathrm{Attribute}), \mathrm{ with } I(x) = \frac{\sum p_i + n_i}{p + n},\]
    where $p_i$ denotes the number of yes values, $n_i$ denotes the number of no values for a particular attribute, $p$ and $n$ are the numbers of yes and noes of the entire sample and S denotes the entire sample~\cite{rao_crop_2022}. Last but not least, a random forest classifier has also been trained, which predicts a crop class based on majority voting between multiple decision trees which are created at random based on samples from the training dataset~\cite{rao_crop_2022}. During their experiments, the random forest performed the best, however all models were able to report an accuracy between 97\% and 99.5\%. Other researchers combined all of the three models by adding a voting classifier, that takes the prediction of each of the models as input and returns the class with the highest probability through majority voting~\cite{pragathi_crop_nodate}.
    In an experiment to harness the power of deeplearning, Dupuis et. al. applied a Recurrent Neural Network (RNN), to crop rotation sequences in order to predict following crop rotation cycles~\cite{dupuis_performances_2023}. To achieve this, a sequence to sequence encoder-decoder RNN architecture composed of LSTMs has been trained using teacher forcing to predict the most probable sequence of crops in a field in year $n+1$ to $n+x$. The encoder LSTM cells create a context vector, that encodes the relevant information of the whole input sequence, the decoder cells are then initialized based on this context vector~\cite{dupuis_methodology_2023}. Initializing the decoder with the context vector from the encoder cells allows the model to connect the information extracted by the encoder to be linked by the decoder. The decoder output is then fed into a softmax layer, returning a probability vector of the occurence of activities at time $t$. As a result, the RNN returns a probability matrix of size $n_{out}\times n_{crops}$. Beam search is then applied to this matrix, aiming to maximize the overall probability that a sequence is completed using a log-likelihood score~\cite{dupuis_methodology_2023}. Beamsearch then extracts a configurable number of probable sequences. In order to later new unobserved sequences, as they could contain serious agronomical errors, a conditional probability table is created. This table encodes the probabilities of already observed sequences to occur using maximum likelyhood estimates. The results from beamsearch are then ordered by linearly fusing the beamsearch scores of the sequences with their respective entries in the conditional probability table, ultimately returning a ranking of possible sequences~\cite{dupuis_performances_2023}.

    \subsection{Input data}
    As explained in Section~\ref{sec:def}, a lot of different factors play a role in decision-making for crop rotations. Different methods, therefore are using different amounts and kinds of input data. Classic approaches, facilitate all available data around the topic, as specialized agronomists are carefully selecting crop strategies based on annual crop maps, spatial and temporal factors, as well as soil properties and the crop of the year before are taken into account. In addition agronomists also have the whole economic context and crop distribution of the whole farm at hand. Automated approaches don't have this luxury.\\
    The approach based on the creation of TPMs for crop prediction used annual crop maps over a time of six years, to derive reoccurring sequences as well as spatial metadata for each sequence. With that, the authors were able to produce crop rotation prediction on a per field scale depending on spatial, environmental and topological information encoded in the metadata~\cite{upcott_new_2023}. Dupuis et. al.~\cite{dupuis_methodology_2023} facilitated a similar approach in terms of input data, with the exception that no spatial information was included. Thus, only crop rotation sequences observed over the whole train and test set have been used, with no additional information.\\
    Other machine learning approaches such as the voting classifier~\cite{pragathi_crop_nodate}, as well as the KNN, decision tree and random forest classifiers~\cite{rao_crop_2022} faced the challenge of crop rotation prediction from an agronomical, rather than a historical point of view. All approaches used the \enquote{Crop Recommendation} dataset from Kaggle~\cite{rao_crop_2022}. This dataset includes seven features, the Nitrogen content ratio, Phosphorus content ratio, Potassium content ratio of the soil and the temperature, relative humidity, ph value and rainfall in milimeters for a given crop for multiple observations. Thus, these models take the soil properties and weather circumstances into account when predicting a suitable crop type, without any spatial or temporal information.

    \subsection{Goals}
    In terms of the overall goal, all approaches have the same overall goal, predicting a crop for crop rotation at a certain input. However, the TPMs by Upcott et. al.~\cite{upcott_new_2023} aim at predicting the best crop for a given sequence and thus, following the direct principle of crop rotation. The same holds for the sequence to sequence approach by Dubuis et. al.~\cite{dupuis_performances_2023}. Both facilitate the core principle of crop rotation in predicting (reoccurring) sequences, that fit to the previous applications of the farmer based on previous crop rotation cycles and thus support farmers in establishing a \textit{stable} crop rotation cycle. The voting classifier~\cite{pragathi_crop_nodate}, as well as the KNN, decision tree and random forest classifiers~\cite{rao_crop_2022} have a different goal. All of them take the soil properties and weather into account when predicting the best crop. As their predictions are solely reliant on agronomical information of the current state of the environment, these models effectively aim at maximizing the short term yield and with that economic return, by predicting the most suitable crop~\cite{pragathi_crop_nodate}.

    \section{Usability \& Practical Relevance}
    All models try to support farmers and agronomists in their decision making for crop rotation and cropping plans. Some models as the TPMs with spatial dependencies or the sequence to sequence lstms model crop rotation patterns, while others only predict a suitable crop based on the current soil properties and weather. The models who model the sequential and temporal dimension of crop rotation, achieve this by only taking historically observed rotation patterns and sequences in to account. Even though, some of them like the LSTM based RNN are abled to model new unobserved sequences, these sequences are not checked for agronomic suitability. They may model the temporal and reocurring dimension and also associate spatial components with them to make the prediction more precise, however, they completely ignore agronomical information of a given field or farm. In addition to that, they don't take economic factors into account. As an example, growing maize over wheat in an oversatisfied maize market won't be profitable, these models will recommend growing maize anyways if it historically was grown often in a given sequence. Also, temporal erorrs made by humans reproduce over time, e.g. a farmer uses the wrong rotations for a field for a set of $n$ years, the consequences of this are sometimes slow and aren't directly noticeable~\cite{upcott_new_2023}. In this kind of approach, the faulty sequences would get assigned a high probability, as they occur often in the area in question.\\
    The machine learning approaches based on the Crop Recommendation dataset on the other hand, don't take spatial or historic information into account, instead, they only use agronomic information such as the current soil properties and weather. Thus they don't encode knowledge about common rotations, what crop has been grown before or any other general information associated with the given area. Thus, they can only give a short-term prediction, that is unaware of any environmental and economic side effects. In addition, these models are not able to produce stable crop rotation sequences, as each position of a sequence has to be generated at the point of seeding.\\
    Overall, all models don't model a farmers needs to derive a cropping plan from crop rotation properly. They all model a certain aspect without taking in to account the whole picture. At best, a farmer can predict a sequence or crop for a given field. This prediction however will not take the whole farm context in to account that is needed to form a cropping plan and select suitable crop rotations, such as the overall crop distribution, economic factors, effects of crop combinations on an agronomic level. The current models only form some form of reconstruction or classification task but they are not optimizing important metrics for farmers, such as economic profitability and return, soil properties over time, minimizing weather risks etc. Therfore, none of the proposed approaches pose a usable end-to-end workflow / model for farmers and agronomists to use. The creation of a cropping plan would still require a lot of manual labor, with a lot of specialised expertise. This shows, that a lot of research still has to be done in this area, to minimize costs and optimize current farming practices. In addition, current state-of-the-art methods for the processing of sequences are also not taken into consideration, leading to the utilization of smaller models, that gracieously underfit the complexity of the overall problem. In addition, a dataset that sufficiently models all aspects of this decision process is also not available and thus aggravates the research and increases the funding needed for such systems.

    \section{Conclusion}
    In this paper, the problem of crop rotation and the overall goal of deriving a stable cropping plan for a farm has been outlined. Then current advances in research have been presented and categorized based on their methodology, input data and their overall goal. After that, the presented methods have been discussed in terms of their overall usability and practical relevance. In total nine approaches have been discussed. The classic approach, taken by a lot of farmers still seems to be the best way to derive accurate forecasts and a stable cropping plan, that takes into account all factors. However, it needs specialised experts in the field of agronomics to aid the decision making process. Advances in Data Analysis, such as the creation of spatially dependend TPMs showed good prediction performance on a field level. However, it completely relies on historic rotation data and is unaware of other important factors such as soil properties or economic circumstances. Machine Learning takes the task of prediction rotation sequences a step further by prediction sequences for multiple timestamps instead of only the next one. But, it faces the same problems as the spatial TPM approach. Other machine learning methods, have modelled the agronomic dimension of crop rotations by classifying suitable crops based on soil properties and weather data. These however, are also leaving out many important factors, such as economic factors and temporal information. Overall, it was deemed that none of the presented methods of current research advances are able to properly model the decision problems associated with the creation of a stable cropping plan. In addition, none pose a usable end-to-end crop prediction framework, that takes enough information into account and encodes sufficient knowledge. Also, none of the approaches, except the sequence to sequnce RNN, used current state-of-the-art deeplearning methods for sequence processing such as transformers. A proper dataset that models the complete decision process is also missing. Therefore, a lot of research has to be done in the are of crop rotation prediction, that involves the creation of a dataset that models the domain correctly and yields an end-to-end decision support framework for farmers and agronomists alike.

%TC:ignore
%\clearpage %add new page for references
    \singlespacing
    \emergencystretch 3em
    \hfuzz 1px
    \printbibliography[heading=bibnumbered]

% \clearpage
% \begin{appendices}

% \section{Here go any appendices!}

% \end{appendices}

%TC:endignore
\end{document}